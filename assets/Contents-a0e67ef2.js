import{i,j as e,c as D,N as A,d as O,f as P,P as a,p as S,g as F}from"./index-216c0cc6.js";import{r as l}from"./react-7b82c02c.js";import{e as V}from"./reactRouter-08e27dd4.js";import"./extra-3c07f53d.js";const Y="l8--",K="aJfT",Z="xXbq",Q="e67c",z="P0pX",J="ZIqZ",W="Ihk1",ee="lI6k",te="_9xbH",se="wj98",re="vMI8",ne="toXg",ie="yf5t",oe="Y0D-",ae="X6OP",le="-ldP",ce="_0-rw",de="rRQH",me="_5tHo",pe="uagu",ue="Bonk",xe="f93p",he="VB5A",ge="IuFi",fe="T6YH",be="pXCt",we="azvj",ve="jsp9",je="EV70",ye="TkHi",Ne="G9tB",Ie="Zt2o",Te="NZ60",Re="njvt",ke="_6eYt",Be="_5ndV",_e="Mnef",Se="IMRP",Ce="Dkuf",qe="_5vGo",Ee="IdrJ",Fe="_0Nlh",De="tNkc",Ae="bYUD",Oe="D0Ok",Pe="Z2Xr",$e="BwJP",Me="_4jer",He="xENC",Xe="qVUm",Ge="OgZ5",Le="qrUP",Ue="YCS-",Ve="qxMK",Ye="DLC5",Ke="_4Qt1",Ze="_7opu",Qe="i2Fh",ze="Ya0v",Je="Ap7N",We="LVaN",et="t06S",tt="_7-27",st="PjwE",t={container:Y,"sr-only":"BdGs",invisible:K,fixed:Z,absolute:Q,relative:z,"inset-0":"f8ye","-left-[1.0625rem]":"p0i4","-top-1":"xtQp","-top-4":"mAYP","bottom-[0%]":"_6yj1","left-[-20%]":"iMoz","left-[7%]":"TcgU","left-[calc(50vw_-_200px)]":"NrLm","right-0":"BvOn","right-5":"U8i5","right-[24px]":"AenE","right-[3.5rem]":"_6yRd","right-[7%]":"GK2e","top-3":"FzsK","top-[5%]":"amc-","top-[5.833rem]":"_7xj1","top-[calc(50vh_-_100px)]":"Xm5t","z-10":"rhX1","z-50":"tfhj","m-2":"AdzG","mx-auto":"_8-8b","my-1":"THOm","my-1.5":"cqP7","my-2":"SXI6","my-3":"XEsM","my-4":"_0-fX","my-5":"_296b","my-[5%]":"AXeu","my-auto":"ntZv","-mt-0":"GSM8","-mt-0.5":"BTQk","mb-10":"fabv","mb-3":"-Oy2","mb-4":"iJdd","mb-[0.9375rem]":"KH64","mb-[1%]":"HQLr","mb-[2%]":"C0Jj","mb-[4%]":"lT-Q","ml-2":"tf3W","ml-4":"hlfK","ml-5":"_3zct","ml-[0.3125rem]":"RYhR","ml-[3%]":"LOyI","ml-[3rem]":"HTcM","mr-[2.375rem]":"vTxv","mt-1":"DLF-","mt-1.5":"xNgH","mt-2":"zLja","mt-3":"Bqso","mt-4":"qYGW","mt-8":"_1PeR","mt-[0.2em]":"_1Svj","mt-[1.5625rem]":"N0cR","mt-[1rem]":"QA1n","box-border":"blgR",block:J,"inline-block":"nwIw",flex:W,table:ee,contents:te,hidden:se,"h-1/4":"jOjI","h-10":"ng-O","h-16":"qrw9","h-2":"t8FU","h-20":"_9aq3","h-8":"_4hPM","h-[0.0625rem]":"Ht05","h-[10%]":"X5Q0","h-[100vh]":"iQcI","h-[13.875rem]":"Oc3Y","h-[2.375rem]":"aWUG","h-[4rem]":"_7bzy","h-[9.375rem]":"HcId","h-auto":"_6GBo","h-full":"mz79","h-screen":"gOG6","min-h-[1rem]":"_9ngx","min-h-[3.5rem]":"xmI9","min-h-[3rem]":"_-5vY","min-h-full":"QZeh","min-h-min":"ZqRh","w-1/2":"_9-7e","w-1/3":"_5bA8","w-10":"_4w4Y","w-2":"ar--","w-2/3":"pFVC","w-2/5":"fVyM","w-6/12":"m6nF","w-[13.87rem]":"TIW2","w-[2.375rem]":"lPdI","w-[23%]":"T4Rm","w-[25rem]":"CfKb","w-[30%]":"Anox","w-[35%]":"f2iK","w-[4rem]":"_8KAr","w-[5%]":"h-fp","w-[50%]":"H9w5","w-[6.5%]":"sg25","w-[60%]":"nLFO","w-auto":"mblZ","w-full":"F4F5","w-screen":"fjM6","min-w-[15rem]":"QLXV","min-w-[1rem]":"_4ZHK","flex-grow":"KvA2","table-fixed":"_19zF","-translate-x-1/2":"zNTi","-translate-y-1/2":"ZgGr","-translate-y-2":"-h-F","-translate-y-2.5":"hdrQ","translate-x-0":"E9kw",transform:re,"cursor-pointer":"ZGnr","list-none":"OGGK","flex-row":"gAeF","flex-col":"qy7E","flex-wrap":"HPPn","items-center":"FhR3","justify-center":"baCN","justify-between":"RyZr","justify-around":"_5IFa","gap-1":"_6sHY","gap-10":"N1Cz","gap-2":"gnj-","gap-3":"qCkP","gap-5":"UJ2O","gap-6":"ThZl","gap-7":"D0Xc","self-center":"FhCy","overflow-hidden":"HTDu","overflow-y-visible":"wXSi",truncate:ne,"text-ellipsis":"_4end","whitespace-nowrap":"Ug5s","whitespace-pre-wrap":"AuNT",rounded:ie,"rounded-full":"a09b","rounded-sm":"MXUa","rounded-ee-sm":"QJ-0","rounded-ss-sm":"FquZ",border:oe,"border-b":"GEz-","border-l":"Df-n","border-t":"c-Gq","border-solid":"aquk","border-[#2e2e2e]":"NdRX","border-[#464646]":"a2jD","border-[#4d4d4d]":"yT-m","border-[#5e5e5e]":"_6TSs","border-[#dedede]":"D8As","border-gray300":"YYNS","border-gray400":"JYBF","border-green-600":"nX9-","border-red-500":"_7j5b","border-red-600":"_5s-2","border-slate-300":"V0CE","border-slate-400":"o9GV","bg-[#191919]":"J971","bg-[#212121]":"m-Zc","bg-[#2e2e2e]":"AiR4","bg-[#dedede]":"gqRe","bg-[#ff153c]":"QI70","bg-[#ff1f45]":"xRnt","bg-black":"NPEm","bg-black/[80%]":"IqWo","bg-gray700":"oPh-","bg-gray800":"XCvl","bg-transparent":"GCYy","bg-white":"nxtU","to-transparent":"tgi3","bg-contain":"qv4g","bg-cover":"_6jVU","bg-[50%_50%]":"nwRK","bg-no-repeat":"_33OL","object-cover":"IYqS","p-0":"xfcF","p-12":"HQzY","p-2":"OWIy","p-[1%]":"qvhA","px-0":"TaSA","px-0.5":"lJMR","px-10":"MPdA","px-20":"eXr4","px-4":"_3-es","px-5":"A0oV","px-[1.667rem]":"_1dqn","px-[3.5%]":"LdIl","px-[3rem]":"mYZb","px-[5%]":"HItC","py-2":"Rfig","py-3":"_48iL","py-4":"t8Wc","py-6":"-NbK","py-[30%]":"dNt-","pb-10":"a-j7","pb-2":"BieS","pb-3":"tCZ2","pb-[0.125rem]":"T11m","pb-[1.167rem]":"Lhm6","pb-[30px]":"khH-","pb-[8%]":"v57K","pl-0":"UTQe","pl-5":"Nq25","pl-8":"XbTw","pl-[1.375rem]":"u28U","pl-[1rem]":"_7CAp","pl-[5%]":"V6bb","pr-3":"ubT3","pr-5":"DgZZ","pr-7":"-WhH","pr-[0.5rem]":"_8v1M","pr-[7px]":"yiYL","pt-1":"cGiJ","pt-10":"SvKO","pt-2":"_1teO","pt-32":"IMLo","pt-6":"u3OQ","pt-[0.5625rem]":"dcoN","pt-[0.625rem]":"WjLW","pt-[12%]":"SCuG","pt-[15px]":"ln-K","pt-[1rem]":"obsO","pt-[2rem]":"Rpc-","pt-[7%]":"F2AL","pt-[70px]":"gwsk","text-left":"C-kb","text-center":"tJl0","text-right":"fOS1","align-middle":"hDyg","font-sans":"p-Xd","text-2xl":"WgfF","text-3xl":"paSh","text-4xl":"WlXh","text-[0.625rem]":"zTdq","text-[0.6875rem]":"_8-HE","text-[0.75rem]":"u-cJ","text-[0.875rem]":"QnQR","text-[0.9375rem]":"Vrow","text-[1.25rem]":"t3Ax","text-[7rem]":"r8--","text-base":"Nj9g","text-lg":"lXf7","text-sm":"_3kva","text-xl":"oBMq","text-xs":"BGxV","font-[0.75rem]":"ss3B","font-bold":"Yowi","font-extrabold":"we2P","font-extralight":"NBXE","font-light":"a-3l","font-medium":"v3kF","font-normal":"_9fhG","font-semibold":"wijM",italic:ae,"leading-10":"ARns","leading-3":"AlH4","leading-4":"mMec","leading-[1.15]":"nhQh","leading-[6rem]":"o2ah","leading-[normal]":"xXDc","leading-normal":"vG3o","leading-relaxed":"zvRE","tracking-wide":"ImFT","tracking-wider":"Cu13","text-[#646464]":"R1nj","text-[#6e6e6e]":"k8EK","text-[#888888]":"RwYZ","text-[#A3A3A3]":"QkYv","text-[#a3a3a3]":"J4Me","text-[#a6a6a6]":"RkkZ","text-[#dedede]":"sbWK","text-[#ededed]":"_0iAN","text-[gray]":"zRKi","text-black":"T4pZ","text-gray-300":"oZbt","text-gray-400":"_5JvX","text-gray300":"egme","text-gray400":"RxZF","text-gray500":"bWHU","text-neutral-400":"_7CB9","text-red-400":"DfEs","text-red-500":"CWUa","text-slate-300":"_4JbF","text-white":"s0yA",underline:le,"placeholder-slate-600":"r01y","opacity-0":"r7Mr","opacity-50":"kXf9","opacity-60":"_6jOt","opacity-70":"_4g9G","opacity-[95%]":"_-6ur","shadow-[0px_5px_10px_0_rgba(0,0,0,0.5)]":"jIYn","saturate-100":"csO3",filter:ce,"backdrop-blur-lg":"XHqt","transition-[color]":"ziJq","transition-all":"kY8W","transition-colors":"-im-","transition-opacity":"TGqB","delay-[0s]":"UxRl","duration-100":"j2jL","duration-[0.05s]":"CADL","duration-[0.1s]":"_8iAB","ease-[ease]":"br-C","ease-in-out":"YE2M","ease-linear":"jG4D",main:de,article:me,articleBg:pe,articleTitle:ue,gradation:xe,sharePopup:he,tag:ge,titleInfo:fe,imgBtn:be,shareImg:we,facebookIcon:ve,twitterIcon:je,linkIcon:ye,poster:Ne,moreInfo:Ie,playBtn:Te,likeBtn:Re,heartBtn:ke,fullHeartBtn:Be,shareBtn:_e,section:Se,sectionTitle:Ce,programFont:qe,sortBtn:Ee,sectionDiv:Fe,toggleBtn:De,circle:Ae,off:Oe,on:Pe,playOn:$e,playOff:Me,asc:He,desc:Xe,reviewSection:Ge,starIcon:Le,active:Ue,star:Ve,figureHoverEffect:Ye,reviewForm:Ke,reviewInput:Ze,reviewButton:Qe,reviewBox:ze,editItem:Je,reviewItem:We,deleteBtn:et,editBtn:tt,editInput:st,"first-line:transform":"M2Mo","hover:border-white":"yIAc","hover:bg-[#2e2e2e]":"L3Nq","hover:bg-white":"_3Bup","hover:text-white":"RTGe","dark:hover:bg-[#cc1030]":"mLY2","max-sm:px-12":"bVcb","md:pt-[1rem]":"hLMw","lg:pt-[1.5rem]":"p2cz"};function $({similar:s}){return e.jsxs("section",{className:t.section,children:[e.jsx("span",{className:t.sectionTitle,children:"비슷한 TV 프로그램"}),e.jsx("div",{className:t.programFont,children:e.jsxs(D,{className:"detailSwiper detailPagenation px-[3rem]  overflow-y-visible   ",modules:[A,O],slidesPerView:7,spaceBetween:10,slidesPerGroup:7,tabIndex:0,freeMode:!0,breakpoints:{480:{slidesPerView:5},768:{slidesPerView:6},1024:{slidesPerView:7}},navigation:{nextEl:"#nextButton",prevEl:"#prevButton",keyboard:{enabled:!0,onlyInViewport:!1}},pagination:{clickable:!0},children:[s.map((n,d)=>e.jsx(P,{children:e.jsxs("figure",{className:`pt-[0.5625rem] ${t.figureHoverEffect}`,children:[e.jsx("img",{src:n.thumbUrl,alt:`Episode Thumbnail ${d}`}),e.jsx("figcaption",{className:" pt-[0.5625rem]",children:e.jsx("h4",{children:n.info})})]})},d)),e.jsx("div",{className:"swiper-button-prev",id:"prevButton",role:"button",tabIndex:0,onKeyDown:n=>{n.key==="Enter"&&n.currentTarget.click()}}),e.jsx("div",{className:"swiper-button-next",id:"nextButton",role:"button",tabIndex:0,onKeyDown:n=>{n.key==="Enter"&&n.currentTarget.click()}})]})})]})}$.propTypes={similar:i.arrayOf(i.shape({thumbUrl:i.string.isRequired,info:i.string.isRequired})).isRequired};function M({isToggled:s,onToggle:n}){return e.jsx("button",{className:`text-white ${t.toggleBtn} ${s?`${t.on}`:`${t.off}`}`,type:"submit",onClick:n,children:e.jsx("div",{className:t.circle})})}M.propTypes={isToggled:i.bool.isRequired,onToggle:i.func.isRequired};function H({state:s,setState:n,title:d,episodeThumbs:w,sortKey:m}){const[h,v]=l.useState(!0),[g,f]=l.useState(!1),_=()=>{f(!g)},C=()=>{const o=[...s.episodes].sort((c,R)=>{const b=parseInt(c.title.split(",")[0]),I=parseInt(R.title.split(",")[0]);return b-I});n(c=>({...c,episodes:o})),v(!0)},q=()=>{const o=[...s.episodes].sort((c,R)=>{const b=parseInt(c.title.split(",")[0]);return parseInt(R.title.split(",")[0])-b});n(c=>({...c,episodes:o})),v(!1)};return e.jsxs("section",{className:t.section,children:[e.jsx("hr",{className:"border-gray400"}),e.jsxs("div",{className:t.sectionDiv,children:[e.jsxs("button",{className:t.sectionTitle,type:"submit",children:[d,e.jsx("div",{children:w.map((o,c)=>e.jsx("img",{src:o,alt:`Episode Thumbnail ${c}`},c))})]}),e.jsxs("div",{className:t.sortBtn,children:[e.jsx("button",{className:`${h?`${t.asc}`:`${t.desc}`}`,type:"submit",onClick:C,children:"첫화부터"}),e.jsx("button",{className:`pl-[1.375rem] mr-[2.375rem] ${h?`${t.desc}`:`${t.asc}`}`,type:"submit",onClick:q,children:"최신화부터"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:` pr-[0.5rem] ${g?`${t.playOn}`:`${t.playOff}`}`,children:"연속재생"}),e.jsx(M,{isToggled:g,onToggle:_})]})]})]}),e.jsx("div",{className:" w-full font-semibold",children:e.jsxs(D,{className:"px-[3rem] detailSwiper",spaceBetween:10,modules:[O,A],slidesPerView:4,tabIndex:0,breakpoints:{480:{slidesPerView:2},768:{slidesPerView:3},1024:{slidesPerView:4}},navigation:{nextEl:"#nextButton",prevEl:"#prevButton",keyboard:{enabled:!0,onlyInViewport:!1}},children:[s.episodes.map((o,c)=>e.jsx(P,{children:e.jsxs("figure",{className:`pt-[0.5625rem] ${t.figureHoverEffect}`,children:[e.jsx("img",{src:o.thumbUrl,alt:`Episode Thumbnail ${c}`}),e.jsxs("figcaption",{className:" pt-[0.5625rem]",children:[e.jsx("h4",{className:"text-white text-lg",children:o.title}),e.jsx("p",{children:o.info})]})]})},c)),e.jsx("div",{className:"swiper-button-prev",id:"prevButton",role:"button",tabIndex:0,onKeyDown:o=>{o.key==="Enter"&&o.currentTarget.click()}}),e.jsx("div",{className:"swiper-button-next",id:"nextButton",role:"button",tabIndex:0,onKeyDown:o=>{o.key==="Enter"&&o.currentTarget.click()}})]},m)})]})}H.propTypes={state:i.shape({episodes:i.arrayOf(i.shape({title:i.string.isRequired})).isRequired}).isRequired,setState:i.func.isRequired,title:i.string.isRequired,episodeThumbs:i.arrayOf(i.string).isRequired,handleClick:i.func.isRequired,sortKey:i.any.isRequired};const rt="/react-project-7/assets/twitter-logo.png",nt="/react-project-7/assets/share-logo.png",it="/react-project-7/assets/facebook-logo.png";function E({platform:s,url:n,src:d}){const w=()=>{if(s==="Facebook"){const m=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(n)}`;window.open(m,"_blank")}else if(s==="Twitter"){const h=`https://twitter.com/intent/tweet?text=${encodeURIComponent("티빙! 오리지널을 만나보세요.")}&url=${encodeURIComponent(n)}`;window.open(h,"_blank")}else s==="Link"&&(navigator.clipboard.writeText(n),alert("링크가 복사되었습니다!"))};return e.jsx("button",{onClick:w,children:e.jsx("img",{className:t[`${s.toLowerCase()}Icon`],src:d,alt:`${s} 공유 아이콘`})})}E.propTypes={platform:i.string.isRequired,url:i.string.isRequired,src:i.string.isRequired};function X({state:s,setState:n,ratingText:d,versionText:w,handleHeart:m,isChanged:h,setIsShareOpen:v,isShareOpen:g}){return e.jsxs("article",{className:t.article,children:[e.jsx("div",{className:`${t.gradation} -translate-x-1/2 -translate-y-1/2`,children:e.jsx("div",{className:t.poster,style:{backgroundImage:`url(${s.poster})`}})}),e.jsxs("div",{className:t.articleBg,children:[e.jsxs("div",{className:"w-2/5 p-[1%]",children:[e.jsx("h2",{className:t.articleTitle,children:s.title}),e.jsxs("div",{className:"border-gray300 ",children:[e.jsx("span",{className:t.tag,children:s.release}),e.jsx("span",{className:t.tag,children:d[s.rating]}),s.runningTime&&e.jsxs("span",{className:t.tag,children:[s.runningTime,"분"]}),s.version!=="X"&&s.version&&s.version!=="x"&&e.jsx("span",{className:t.tag,children:w[s.version]}),s.producer&&e.jsx("span",{className:t.tag,children:s.producer}),s.season&&e.jsxs("span",{className:t.tag,children:["시즌",s.season]}),s.subtitle&&e.jsx("span",{className:t.tag,children:"자막"}),s.isDRM&&e.jsx("span",{className:t.tag,children:"DRM"})]}),e.jsxs("div",{className:"flex",children:[e.jsxs("button",{className:t.playBtn,type:"submit",children:[e.jsx("span",{className:"text-center",children:"▶"})," 시청하기"]}),e.jsxs("button",{className:t.likeBtn,type:"submit",onClick:m,children:[e.jsx("img",{className:t.imgBtn,src:h?"assets/full-heart.svg":"assets/heart.svg",alt:"하트 버튼"}),e.jsx("span",{className:"text-white",children:"찜"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{className:t.likeBtn,type:"submit",onClick:()=>v(!g),children:[e.jsx("img",{className:t.shareBtn,alt:"공유 버튼"}),e.jsx("span",{className:"text-white",children:"공유"})]}),g&&e.jsxs("div",{className:`${t.sharePopup} flex justify-around items-center`,children:[e.jsx(E,{platform:"Link",url:window.location.href,src:nt}),e.jsx(E,{platform:"Facebook",url:"https://www.facebook.com/sharer/sharer.php",src:it}),e.jsx(E,{platform:"Twitter",url:window.location.href,src:rt})]})]})]}),e.jsxs("dl",{className:"flex mt-[1.5625rem] font-semibold",children:[e.jsx("dt",{className:t.titleInfo,children:"크리에이터"}),e.jsx("dd",{className:t.truncate,children:s.creator})]}),e.jsxs("dl",{className:"flex font-semibold",children:[e.jsx("dt",{className:t.titleInfo,children:"출연"}),e.jsx("p",{className:`${t.actor} ${t.truncate}`,children:s.actor})]}),e.jsx("p",{className:`${t.moreInfo} ${s.showFullDescription?"":t.truncate}`,children:s.description}),e.jsx("button",{onClick:()=>n(f=>({...f,showFullDescription:!f.showFullDescription})),type:"button",children:s.showFullDescription?"접기":"더보기"})]}),e.jsx("div",{className:"w-[23%]",children:e.jsx("img",{className:"",src:s.poster})})]})]})}X.propTypes={state:a.shape({showFullDescription:a.bool,title:a.string,producer:a.bool,poster:a.string,actor:a.string,creator:a.string,description:a.string,release:a.string,rating:a.string,version:a.string,season:a.bool,subtitle:a.bool,isDRM:a.bool,runningTime:a.bool}).isRequired,ratingText:a.object.isRequired,versionText:a.object.isRequired,handleHeart:a.func.isRequired,isChanged:a.bool.isRequired,setIsShareOpen:a.func.isRequired,setState:a.func.isRequired,isShareOpen:a.bool.isRequired};function G({star:s="별점",writer:n="글쓴이",comment:d="리뷰",commentId:w}){const[m,h]=l.useState(!1),[v,g]=l.useState(!1),[f,_]=l.useState(d),[C,q]=l.useState(d),o=async()=>{try{await S.collection("review").delete(w),g(!0)}catch(b){console.error(b)}},c=()=>{h(!0)},R=async b=>{if(!m)return;const I={contents:f};try{await S.collection("review").update(b,I),h(!1),q(f)}catch(j){throw new Error(j.message)}};return e.jsx(e.Fragment,{children:v?e.jsx(e.Fragment,{children:e.jsx("p",{className:" pl-[1rem] pt-[0.625rem] mt-[1rem] ml-[3rem]",children:"관리자만 접근이 가능합니다."})}):e.jsxs("div",{className:t.editItem,children:[e.jsx("div",{children:Array.from({length:s},(b,I)=>e.jsx("span",{children:"⭐"},I))}),e.jsxs("div",{className:" flex row",children:[n,"  : ",m?e.jsx("input",{className:"text-[gray]",type:"text",value:f,onChange:b=>_(b.target.value)}):e.jsx("div",{className:"",children:f}),m&&e.jsx("div",{className:" cursor-pointer ",children:e.jsx("ul",{className:"flex row",children:e.jsx("li",{className:" ml-[0.3125rem] mt-[0.2em]",children:e.jsx("button",{onClick:()=>R(w),children:"수정"})})})}),!m&&e.jsxs(e.Fragment,{children:[e.jsx("span",{onClick:c,className:`${t.deleteBtn} text-[gray]`,children:"수정"}),e.jsx("span",{onClick:o,className:`${t.deleteBtn} text-red-500`,children:"삭제"})]})]})]})})}G.propTypes={star:i.number.isRequired,writer:i.string.isRequired,comment:i.string.isRequired,commentId:i.string.isRequired};function L({id:s,contentType:n}){const[d,w]=l.useState(0),[m,h]=l.useState(0),[v,g]=l.useState(""),[f,_]=l.useState([]),[C,q]=l.useState(null),[o,c]=l.useState(""),R=l.useRef(null),[b,I]=l.useState([]),j=p=>{C!==null?c(p.target.value):g(p.target.value)},r=async p=>{var y;p.preventDefault();const x=JSON.parse(localStorage.getItem("pocketbase_auth")||"{}"),k=(y=x==null?void 0:x.model)==null?void 0:y.id;if((v!==""||o!=="")&&d!==null)try{let T;C!==null?T={text:o,stars:d.toString()}:T={text:v,stars:d.toString()};let B={star:T.stars,writer:k,contents:T.text,programId:s},u=await S.collection("review").create(B);u&&(await S.collection("users").update(k,{"review+":u.id}),await S.collection(n).update(B.programId,{"reviews+":u.id}));let N=await S.collection("review").getOne(u.id,{expand:"writer"});_(U=>[...U,N])}catch(T){console.error(T)}};return e.jsxs("section",{className:t.reviewSection,children:[e.jsx("hr",{className:"border-gray400 pt-[15px]"}),e.jsx("span",{className:`mb-[0.9375rem]  ${t.sectionTitle}`,children:"Review"}),e.jsx("div",{className:t.reviewBox,children:e.jsxs("form",{onSubmit:r,className:t.reviewForm,children:[[...Array(5)].map((p,x)=>{const k=x+1;return e.jsx("span",{className:`${t.starIcon} ${k<=(m||d)?t.active:""}`,onMouseEnter:()=>h(k),onMouseLeave:()=>h(d),onClick:()=>w(k),children:"★"},x)}),e.jsx("input",{className:t.reviewInput,value:v,ref:R,onChange:j}),e.jsx("button",{className:t.reviewButton,type:"submit",children:"리뷰 제출"})]})}),e.jsx("div",{children:e.jsx("ul",{className:"",children:f.map(p=>(console.log(p),e.jsx(G,{star:p.star,writer:p.expand.writer.username,comment:p.contents,commentId:p.id,onCommentChange:I},p.id)))})})]})}L.propTypes={id:i.string.isRequired,contentType:i.string.isRequired};function dt(){const[s,n]=l.useState({showFullDescription:!1,title:"",producer:!1,poster:"",actor:"",creator:"",description:"",release:"",rating:"",version:"",season:!1,subtitle:!1,isDRM:!1,runningTime:!1,episodes:[],similar:[],related:[],episodeTitles:"",episodeThumbs:[],similarThumbs:[],relatedTitles:""}),d={all:"전체 이용가",eighteen:"18세",twelve:"12세",fifteen:"15세",seven:"7세"},w={dubbed:"더빙판",subtitle:"자막판"},{id:m}=V(),[h,v]=l.useState([]),[g,f]=l.useState("");l.useEffect(()=>{const I=async j=>{try{const r=await S.collection(j).getOne(m,{expand:"reviews,reviews.writer"});f(r.collectionName),console.log(r);const{expand:p}=r;p&&v(p.reviews);let x={};if(r.poster&&(x.poster=F(r,"poster")),r.episodeThumbs&&r.episodeTitles&&r.episodeInfos){const y=r.episodeThumbs.map(N=>F({collectionId:r.collectionId,id:r.id,[N]:N},N)),T=r.episodeTitles.split(","),B=r.episodeInfos.split(","),u=[];for(let N=0;N<y.length;N++)B[N]&&u.push({thumbUrl:y[N],title:T[N],info:B[N]});x.episodes=u}if(r.similarThumbs&&r.similarInfos){const y=r.similarThumbs.map(u=>F({collectionId:r.collectionId,id:r.id,[u]:u},u)),T=r.similarInfos.split(","),B=[];for(let u=0;u<y.length;u++)T[u]&&B.push({thumbUrl:y[u],info:T[u]});x.similar=B}const k=["title","actor","creator","description","producer","release","season","subtitle","rating","isDRM","episodeTitles","version"];for(let y of k)r[y]&&(x[y]=r[y]);return j==="movie"&&r.runningTime&&(x.runningTime=r.runningTime),j==="movie"&&r.version&&(x.version=r.version),x}catch(r){console.error(`Failed to fetch ${j} data`,r)}};Promise.all([I("program"),I("movie")]).then(([j,r])=>{n(p=>({...p,...j,...r}))}).catch(j=>console.error(j))},[m]);const[_,C]=l.useState(0),[q,o]=l.useState(!1),[c,R]=l.useState(!1),b=()=>{R(!c)};return e.jsxs("main",{className:`text-gray300 ${t.main} w-screen overflow-hidden`,children:[e.jsx(X,{setState:n,state:s,ratingText:d,versionText:w,handleHeart:b,isChanged:c,setIsShareOpen:o,isShareOpen:q}),e.jsxs("div",{children:[g!=="movie"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{state:s,setState:n,title:s.title,episodeThumbs:s.episodeThumbs,sortKey:_}),e.jsx($,{similar:s.similar})]}),e.jsx(L,{id:m,contentType:g})]})]})}export{dt as default};
