import{j as e,g as x,p as d}from"./index-e81f522c.js";import{S as N,D as m}from"./EditProfiles.module-aff77463.js";import{u as P}from"./authStore-84235a31.js";import{r as n}from"./react-7b82c02c.js";import{u as F,d as k}from"./reactRouter-bd0fbe8a.js";import"./extra-3c07f53d.js";function S(){const u=F(),a=k().pathname.split("/").pop(),{authState:s}=P(),[i,g]=n.useState({username:""}),[h,f]=n.useState(!0),[r,c]=n.useState({username:"",poster:"",posterFile:null});n.useEffect(()=>{var l;(async()=>{try{f(!0);const o=await d.collection("profile").getOne(a);g(o);const p=r.poster||(o.poster?x(o,"poster"):m);c({username:o.username,poster:p,posterFile:null})}catch(o){console.log(o)}finally{f(!1)}})((l=s==null?void 0:s.user)==null?void 0:l.id)},[s,a]);const b=async(t,l)=>{try{return await d.collection("profile").update(t,l)}catch(o){throw console.error(o),o}},j=t=>{c({...r,username:t.target.value})},w=t=>{t.target.files[0]&&c({...r,poster:URL.createObjectURL(t.target.files[0]),posterFile:t.target.files[0]})};console.log(a);const y=async()=>{var t;try{const l=new FormData;l.append("username",r.username),r.posterFile&&l.append("poster",r.posterFile),await b(i.id,l);const o=await d.collection("profile").getOne(a),p=d.files.getUrl(o,o.poster);c({username:o.username,poster:p||m,posterFile:null}),alert("저장 완료!"),u(`/profile/${(t=s==null?void 0:s.user)==null?void 0:t.id}`)}catch(l){console.error(l)}};console.log(i),n.useEffect(()=>{},[]);const v=()=>{var t;window.confirm("이 페이지를 벗어나면 변경된 내용은 저장되지 않습니다. 그래도 진행하시겠습니까?")?u(`/editprofiles/${(t=s==null?void 0:s.user)==null?void 0:t.id}`):console.log("프로필 편집 취소")};return console.log(r),console.log(i),e.jsx("section",{className:"bg-black w-screen h-screen flex items-center justify-center text-white my-auto relative pt-[2rem] lg:pt-[1.5rem] md:pt-[1rem]",children:e.jsxs("div",{className:"flex flex-col justify-center items-center min-h-full gap-10 w-2/3",children:[e.jsx("div",{className:"flex flex-col gap-1",children:e.jsx("h2",{className:"text-4xl text-center font-bold",children:"프로필 편집"})}),e.jsx("div",{className:"editPoster w-full flex flex-col items-center justify-center gap-1",children:e.jsx("button",{type:"button",className:`${N.editButton} border-solid block w-2/6 h-2/6 overflow-hidden transition-all duration-[0.3s] p-0 rounded-[3px] hover:-translate-y-3 relative object-cover`,children:h?e.jsx("div",{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"poster",className:"cursor-pointer",children:e.jsx("img",{src:r!=null&&r.poster?r==null?void 0:r.poster:x(i,"poster"),alt:"유저 프로필 이미지",onError:t=>{t.target.onerror=null,t.target.src=m},className:"w-[13.87rem] h-[13.875rem] object-cover opacity-50"})}),e.jsx("input",{type:"file",id:"poster",accept:".jpg,.png,.svg,.webp",onChange:w,style:{display:"none"}})]})})}),e.jsxs("div",{className:"editName w-1/2",children:[e.jsx("label",{htmlFor:"username",children:e.jsx("input",{type:"text",name:"username",id:"username",value:r.username,onChange:j,maxLength:"10",className:"w-full h-12 bg-[#191919] text-base leading-normal text-[#4d4d4d] pl-4 py-4 rounded-[3px] border-[solid] border-[#191919] focus:border-[#808080] focus:text-white"})}),e.jsx("p",{className:"text-xs text-neutral-400 my-2",children:"* 2자 이상 10자 이내의 한글, 영문, 숫자 입력 가능합니다."})]}),e.jsxs("div",{className:"buttonWrapper w-1/2 flex justify-between gap-3",children:[e.jsx("button",{type:"button",onClick:y,className:"block w-2/5 box-border border font-bold text-center mt-2 px-0 py-3 border-solid rounded bg-[#dedede] text-black border-[#dedede] hover:border-white hover:bg-white flex-grow",children:"확인"}),e.jsx("button",{type:"button",onClick:v,className:"block w-2/5 box-border border font-bold text-center mt-2 px-0 py-3 border-solid rounded bg-black text-neutral-400 border-[#4e4e4e] hover:border-[#a3a3a3] hover:text-[#dedede] flex-grow",children:"취소"})]})]})})}export{S as default};
